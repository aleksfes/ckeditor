<!DOCTYPE html>
<!--
Copyright (c) 2003-2011, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
-->
<html>
<head>
	<meta charset="utf-8">
	<title>Magicbox muddy trenches &ndash; CKEditor Sample</title>
	<script src="../../../ckeditor.js"></script>
	<link href="../../../samples/sample.css" rel="stylesheet">
	<style>
		body {
			margin: 0;
		}
		#dev {
			position: fixed;
			right: 0px;
			top: 0px;
			bottom: 0px;
			width: 350px;
			padding: 30px;
			background: #ddd;
			font-size: 15px;
		}
		#dev .hl {
			color: red;
		}

		#tr_upper, #tr_lower {
			padding: 3px 6px;
		}
		#tr_upper {
			background: rgba(255,0,0,.3);
		}
		#tr_lower {
			background: rgba(0,255,0,.3);
		}
	</style>
</head>
<body>
	<h1 class="samples">
		CKEditor Sample &mdash; magicbox muddy trenches
	</h1>
	<textarea cols="80" id="editor1" name="editor1" rows="10">
		<hr>
		<p>Lorem ipsum dolor sit amet enim. Etiam ullamcorper. Suspendisse a pellentesque dui, non felis. Maecenas malesuada elit lectus felis, malesuada ultricies</p>
		<hr>
		<hr>
		<p>Lorem ipsum dolor sit amet enim. Etiam ullamcorper. Suspendisse a pellentesque dui, non felis. Maecenas malesuada elit lectus felis, malesuada ultricies</p>
		<table border="1">
			<tbody><tr>
				<td>
					Table Cell 1
				</td>
			</tr>
			<tr>
				<td>
					Table Cell 2<br>
					Table Cell 2<br>
				</td>
			</tr>
			</tbody>
		</table>
		<div style="border: 1px solid red; padding: 50px">
			Parent
			<div style="border: 1px solid green; padding: 10px">Child</div>
		</div>
		<p>Lorem ipsum dolor sit amet enim. Etiam ullamcorper. Suspendisse a pellentesque dui, non felis. Maecenas malesuada elit lectus felis, malesuada ultricies</p>
		<table border="1" style="margin: 15px 0 100px" name="outer">
			<tbody>
			<tr>
				<td>Table Cell 1</td>
				<td>Table Cell 1</td>
			</tr>
			<tr>
				<td>
					<table border="1" name="inner">
						<tbody>
							<tr>
								<td>Table Cell 1</td>
							</tr>
							<tr>
								<td>Table Cell 2<br> Table Cell 2<br></td>
							</tr>
						</tbody>
					</table>
				</td>
			</tr>
			</tbody>
		</table>
		<table border="1" style="margin: 15px">
			<tbody><tr>
				<td>
					Table Cell 1
				</td>
				<td>
					Table Cell 1
				</td>
				<td>
					Table Cell 1
				</td>
				<td>
					Table Cell 1
				</td>
			</tr>
			<tr>
				<td>
					Table Cell 2
				</td>
			</tr>
			</tbody>
		</table>
		<ul style="">
			<li name="ul_first">List item</li>
			<li name="ul_second">
				<ol style="">
					<li name="ol_first">Nested item</li>
					<li>Nested item</li>
					<li>Nested item</li>
				</ol>
			</li>
			<li>List item</li>
		</ul>
		<p>Lorem ipsum dolor sit amet enim. Etiam ullamcorper. Suspendisse a pellentesque dui, non felis. Maecenas malesuada elit lectus felis, malesuada ultricies</p>
		<div><strong>I'm a div. Let me stay here.</strong></div><dl>
			<dt>Key</dt>
			<dd>pendisse a pellentesque dui, non felis</dd>
			<dt>Key</dt>
			<dd>pendisse a pellentesque dui, non felis</dd>
		</dl>
	</textarea>
	<textarea id="editor2">
				<p><div class="navbar" align="center" style="color: rgb(0, 0, 0); font-family: sans-serif; font-size: medium; "><a accesskey="p" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/traversal.html" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">previous</a>&nbsp;&nbsp;&nbsp;<a accesskey="n" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/idl-definitions.html" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">next</a>&nbsp;&nbsp;&nbsp;<a accesskey="c" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/Overview.html#contents" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">contents</a>&nbsp;&nbsp;&nbsp;<a accesskey="i" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/def-index.html" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">index</a><hr title="Navigation area separator"></div><div class="noprint" style="color: rgb(0, 0, 0); font-family: sans-serif; font-size: medium; text-align: right; "><p style="font-family: monospace; font-size: small; ">13 November, 2000</p></div><div class="div1" style="color: rgb(0, 0, 0); font-family: sans-serif; font-size: medium; "><a id="Range" name="Range"></a><h1 id="Range-h1" class="div1" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 27px; font-weight: normal; ">2. Document Object Model Range</h1><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><i>Editors</i></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Peter Sharpe, SoftQuad Software Inc.</dd><dd style="margin-top: 0px; margin-bottom: 0px; ">Vidur Apparao, Netscape Communications Corp.</dd><dd style="margin-top: 0px; margin-bottom: 0px; ">Lauren Wood, SoftQuad Software Inc.</dd></dl><div class="noprint"><h2 id="table-of-contents" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">Table of contents</h2><ul class="toc" style="list-style-type: none; list-style-position: initial; list-style-image: initial; "><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-introduction" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.1. Introduction</a></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Definitions" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.2. Definitions and Notation</a><ul class="toc" style="list-style-type: none; list-style-position: initial; list-style-image: initial; "><li class="tocline4" style="font-style: italic; "><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Position" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.2.1. Position</a></li><li class="tocline4" style="font-style: italic; "><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Containment" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.2.2. Selection and Partial Selection</a></li><li class="tocline4" style="font-style: italic; "><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Notation" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.2.3. Notation</a></li></ul></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Creating" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.3. Creating a Range</a></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Changing" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.4. Changing a Range's Position</a></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Comparing" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.5. Comparing Range Boundary-Points</a></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Deleting-Content" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.6. Deleting Content with a Range</a></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Extracting" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.7. Extracting Content</a></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Cloning" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.8. Cloning Content</a></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Inserting" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.9. Inserting Content</a></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Surrounding" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.10. Surrounding Content</a></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Misc" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.11. Miscellaneous Members</a></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Mutation" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.12. Range modification under document mutation</a><ul class="toc" style="list-style-type: none; list-style-position: initial; list-style-image: initial; "><li class="tocline4" style="font-style: italic; "><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Insertions" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.12.1. Insertions</a></li><li class="tocline4" style="font-style: italic; "><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Deletions" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.12.2. Deletions</a></li></ul></li><li class="tocline3"><a class="tocxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Interface" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">2.13. Formal Description of the Range Interface</a><ul class="toc" style="list-style-type: none; list-style-position: initial; list-style-image: initial; "><li class="tocline4" style="font-style: italic; "><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-idl" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">Range</a>,&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-DocumentRange-idl" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">DocumentRange</a>,&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">RangeException</a>,&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeExceptionCode" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">RangeExceptionCode</a></li></ul></li></ul></div><div class="div2"><a id="Level-2-Range-introduction" name="Level-2-Range-introduction"></a><h2 id="Level-2-Range-introduction-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.1. Introduction</h2><p>A Range identifies a range of content in a Document, DocumentFragment or Attr. It is contiguous in the sense that it can be characterized as selecting all of the content between a pair of boundary-points.</p><p><b>Note:</b>&nbsp;In a text editor or a word processor, a user can make a selection by pressing down the mouse at one point in a document, moving the mouse to another point, and releasing the mouse. The resulting selection is contiguous and consists of the content between the two points.</p><p>The term 'selecting' does not mean that every Range corresponds to a selection made by a GUI user; however, such a selection can be returned to a DOM user as a Range.</p><p><b>Note:</b>&nbsp;In bidirectional writing (Arabic, Hebrew), a range may correspond to a logical selection that is not necessarily contiguous when displayed. A visually contiguous selection, also used in some cases, may not correspond to a single logical selection, and may therefore have to be represented by more than one range.</p><p>The Range interface provides methods for accessing and manipulating the document tree at a higher level than similar methods in the Node interface. The expectation is that each of the methods provided by the Range interface for the insertion, deletion and copying of content can be directly mapped to a series of Node editing operations enabled by DOM Core. In this sense, the Range operations can be viewed as convenience methods that also enable the implementation to optimize common editing patterns.</p><p>This chapter describes the Range interface, including methods for creating and moving a Range and methods for manipulating content with Ranges.</p><p>The interfaces found within this section are not mandatory. A DOM application may use the&nbsp;<code>hasFeature(feature, version)</code>&nbsp;method of the&nbsp;<code>DOMImplementation</code>&nbsp;interface with parameter values "Range" and "2.0" (respectively) to determine whether or not this module is supported by the implementation. In order to fully support this module, an implementation must also support the "Core" feature defined defined in the DOM Level 2 Core specification [<a class="noxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/references.html#DOMCore" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">DOM Level 2 Core</a>]. Please refer to additional information about&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Core/introduction.html#ID-Conformance" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>conformance</em></a>&nbsp;in the DOM Level 2 Core specification [<a class="noxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/references.html#DOMCore" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">DOM Level 2 Core</a>].</p></div><div class="div2"><a id="Level-2-Range-Definitions" name="Level-2-Range-Definitions"></a><h2 id="Level-2-Range-Definitions-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.2. Definitions and Notation</h2><div class="div3"><a id="Level-2-Range-Position" name="Level-2-Range-Position"></a><h3 id="Level-2-Range-Position-h3" class="div3" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 19px; font-weight: normal; ">2.2.1. Position</h3><p>This chapter refers to two different representations of a document: the text or source form that includes the document markup and the tree representation similar to the one described in the introduction section of the DOM Level 2 Core [<a class="noxref" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/references.html#DOMCore" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">DOM Level 2 Core</a>].</p><p>A Range consists of two&nbsp;<i>boundary-points</i>&nbsp;corresponding to the start and the end of the Range.&nbsp;<a id="td-boundarypoint" name="td-boundarypoint"></a>A boundary-point's position in a Document or DocumentFragment tree can be characterized by a node and an offset.&nbsp;<a id="td-container" name="td-container"></a>The node is called the&nbsp;<i>container</i>&nbsp;of the boundary-point and of its position.&nbsp;<a id="td-ancestor-container" name="td-ancestor-container"></a>The container and its ancestors are the&nbsp;<i>ancestor container</i>s of the boundary-point and of its position.<a id="td-offset" name="td-offset"></a>The offset within the node is called the&nbsp;<i>offset</i>&nbsp;of the boundary-point and its position. If the container is an Attr, Document, DocumentFragment, Element or EntityReference node, the offset is between its&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-child" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>child</em></a>&nbsp;nodes. If the container is a CharacterData, Comment or ProcessingInstruction node, the offset is between the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-16-bit-unit" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>16-bit units</em></a>&nbsp;of the UTF-16 encoded string contained by it.</p><p>The&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-points</em></a>&nbsp;of a Range must have a common&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>&nbsp;which is either a Document, DocumentFragment or Attr node. That is, the content of a Range must be entirely within the subtree rooted by a single Document, DocumentFragment or Attr Node.&nbsp;<a id="td-root-container" name="td-root-container"></a>This common&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>&nbsp;is known as the&nbsp;<i>root container</i>&nbsp;of the Range.&nbsp;<a id="td-context-tree" name="td-context-tree"></a>The tree rooted by the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-root-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>root container</em></a>&nbsp;is known as the Range's&nbsp;<i>context tree</i>.</p><p>The&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of a&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;of a Range must be an Element, Comment, ProcessingInstruction, EntityReference, CDATASection, Document, DocumentFragment, Attr, or Text node. None of the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>s of the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;of a Range can be a DocumentType, Entity or Notation node.</p><p>In terms of the text representation of a document, the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-points</em></a>&nbsp;of a Range can only be on token boundaries. That is, the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;of the text range cannot be in the middle of a start- or end-tag of an element or within the name of an entity or character reference. A Range locates a contiguous portion of the content of the structure model.</p><p>The relationship between locations in a text representation of the document and in the Node tree interface of the DOM is illustrated in the following diagram:<br></p><div align="center"><hr width="90%" size="2"><img src="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/images/RangeExample.gif" alt="Range Example"><hr width="90%" size="2"><b>Range Example</b><hr width="90%" size="2"></div><p>In this diagram, four different Ranges are illustrated. The&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-points</em></a>&nbsp;of each Range are labelled with&nbsp;<i>s#</i>&nbsp;(the start of the Range) and&nbsp;<i>e#</i>&nbsp;(the end of the Range), where # is the number of the Range. For Range 2, the start is in the BODY element and is immediately after the H1 element and immediately before the P element, so its position is between the H1 and P children of BODY. The&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of a&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;whose&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;is not a CharacterData node is 0 if it is before the first child, 1 if between the first and second child, and so on. So, for the start of the Range 2, the<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;is BODY and the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;is 1. The&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of a&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;whose&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;is a CharacterData node is obtained similarly but using&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-16-bit-unit" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>16-bit unit</em></a>&nbsp;positions instead. For example, the<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;labelled s1 of the Range 1 has a Text node (the one containing "Title") as its&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;and an&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of 2 since it is between the second and third&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-16-bit-unit" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>16-bit unit</em></a>.</p><p>Notice that the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>s of Ranges 3 and 4 correspond to the same location in the text representation. An important feature of the Range is that a&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;of a Range can unambiguously represent every position within the document tree.</p><p>The&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>s and&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>s of the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>s can be obtained through the following read-only Range attributes:</p><div class="eg"><pre style="margin-left: 2em; ">  readonly attribute Node startContainer;
		  readonly attribute long startOffset;
		  readonly attribute Node endContainer;
		  readonly attribute long endOffset;
		</pre></div><p><a id="td-collapsed" name="td-collapsed"></a>If the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>s of a Range have the same&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>s and&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>s, the Range is said to be a&nbsp;<i>collapsed</i>&nbsp;Range. (This is often referred to as an insertion point in a user agent.)</p></div><div class="div3"><a id="Level-2-Range-Containment" name="Level-2-Range-Containment"></a><h3 id="Level-2-Range-Containment-h3" class="div3" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 19px; font-weight: normal; ">2.2.2. Selection and Partial Selection</h3><p><a id="td-selected" name="td-selected"></a>A node or&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-16-bit-unit" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>16-bit unit</em></a>&nbsp;unit is said to be&nbsp;<i>selected</i>&nbsp;by a Range if it is between the two&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>s of the Range, that is, if the position immediately before the node or 16-bit unit is before the end of the Range and the position immediately after the node or 16-bit unit is after the start of the range. For example, in terms of a text representation of the document, an element would be&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>selected</em></a>by a Range if its corresponding start-tag was located after the start of the Range and its end-tag was located before the end of the Range. In the examples in the above diagram, the Range 2<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>selects</em></a>&nbsp;the P node and the Range 3&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>selects</em></a>&nbsp;the text node containing the text "Blah xyz."</p><p><a id="td-partially-selected" name="td-partially-selected"></a>A node is said to be&nbsp;<i>partially selected</i>&nbsp;by a Range if it is an&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>&nbsp;of exactly one&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;of the Range. For example, consider Range 1 in the above diagram. The element H1 is&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-partially-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>partially selected</em></a>&nbsp;by that Range since the start of the Range is within one of its children.</p></div><div class="div3"><a id="Level-2-Range-Notation" name="Level-2-Range-Notation"></a><h3 id="Level-2-Range-Notation-h3" class="div3" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 19px; font-weight: normal; ">2.2.3. Notation</h3><p>Many of the examples in this chapter are illustrated using a text representation of a document. The&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>s of a Range are indicated by displaying the characters (be they markup or data characters) between the two&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>s in bold, as in</p><div class="eg"><pre style="margin-left: 2em; ">    &lt;FOO&gt;A<b>BC&lt;BAR&gt;DE</b>F&lt;/BAR&gt;&lt;/FOO&gt;

		</pre></div><p>When both&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>s are at the same position, they are indicated with a bold caret ('<b>^</b>'), as in</p><div class="eg"><pre style="margin-left: 2em; ">    &lt;FOO&gt;A<b>^</b>BC&lt;BAR&gt;DEF&lt;/BAR&gt;&lt;/FOO&gt;
		</pre></div></div></div><div class="div2"><a id="Level-2-Range-Creating" name="Level-2-Range-Creating"></a><h2 id="Level-2-Range-Creating-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.3. Creating a Range</h2><p>A Range is created by calling the&nbsp;<code>createRange()</code>&nbsp;method on the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-DocumentRange-idl" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>DocumentRange</code></a>&nbsp;interface. This interface can be obtained from the object implementing the&nbsp;<code>Document</code>&nbsp;interface using binding-specific casting methods.</p><div class="eg"><pre style="margin-left: 2em; ">  interface DocumentRange {
		    Range createRange();
		  }
		</pre></div><p>The initial state of the Range returned from this method is such that both of its&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>s are positioned at the beginning of the corresponding Document, before any content. In other words, the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of each&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;is the Document node and the offset within that node is 0.</p><p>Like some objects created using methods in the Document interface (such as Nodes and DocumentFragments), Ranges created via a particular document instance can select only content associated with that Document, or with DocumentFragments and Attrs for which that Document is the&nbsp;<code>ownerDocument</code>. Such Ranges, then, can not be used with other Document instances.</p></div><div class="div2"><a id="Level-2-Range-Changing" name="Level-2-Range-Changing"></a><h2 id="Level-2-Range-Changing-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.4. Changing a Range's Position</h2><p>A Range's position can be specified by setting the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;and&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of each boundary-point with the&nbsp;<code>setStart</code>&nbsp;and&nbsp;<code>setEnd</code>&nbsp;methods.</p><div class="eg"><pre style="margin-left: 2em; ">  void setStart(in Node parent, in long offset)
		                        raises(RangeException);
		  void setEnd(in Node parent, in long offset)
		                raises(RangeException);
		</pre></div><p>If one boundary-point of a Range is set to have a&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-root-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>root container</em></a>&nbsp;other than the current one for the Range, the Range is&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-collapsed" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>collapsed</em></a>&nbsp;to the new position. This enforces the restriction that both boundary-points of a Range must have the same&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-root-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>root container</em></a>.</p><p>The start position of a Range is guaranteed to never be after the end position. To enforce this restriction, if the start is set to be at a position after the end, the Range is&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-collapsed" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>collapsed</em></a>&nbsp;to that position. Similarly, if the end is set to be at a position before the start, the Range is&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-collapsed" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>collapsed</em></a>&nbsp;to that position.</p><p>It is also possible to set a Range's position relative to nodes in the tree:</p><div class="eg"><pre style="margin-left: 2em; ">  void setStartBefore(in Node node);
		                              raises(RangeException);
		  void setStartAfter(in Node node);
		                       raises(RangeException);
		  void setEndBefore(in Node node);
		                      raises(RangeException);
		  void setEndAfter(in Node node);
		                     raises(RangeException);
		</pre></div><p>The&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-parent" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>parent</em></a>&nbsp;of the node becomes the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;and the Range is subject to the same restrictions as given above in the description of&nbsp;<code>setStart()</code>and&nbsp;<code>setEnd()</code>.</p><p>A Range can be&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-collapsed" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>collapsed</em></a>&nbsp;to either boundary-point:</p><div class="eg"><pre style="margin-left: 2em; ">  void collapse(in boolean toStart);
		</pre></div><p>Passing&nbsp;<code>TRUE</code>&nbsp;as the parameter&nbsp;<code>toStart</code>&nbsp;will&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-collapsed" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>collapse</em></a>&nbsp;the Range to its start,&nbsp;<code>FALSE</code>&nbsp;to its end.</p><p>Testing whether a Range is&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-collapsed" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>collapsed</em></a>&nbsp;can be done by examining the&nbsp;<code>collapsed</code>&nbsp;attribute:</p><div class="eg"><pre style="margin-left: 2em; ">  readonly attribute boolean collapsed;
		</pre></div><p>The following methods can be used to make a Range select the contents of a node or the node itself.</p><div class="eg"><pre style="margin-left: 2em; ">  void selectNode(in Node n);
		  void selectNodeContents(in Node n);
		</pre></div><p>The following examples demonstrate the operation of the methods&nbsp;<code>selectNode</code>&nbsp;and&nbsp;<code>selectNodeContents</code>:</p><div class="eg"><pre style="margin-left: 2em; ">Before:
		  <b>^</b>&lt;BAR&gt;&lt;FOO&gt;A&lt;MOO&gt;B&lt;/MOO&gt;C&lt;/FOO&gt;&lt;/BAR&gt;
		After Range.selectNodeContents(FOO):
		  &lt;BAR&gt;&lt;FOO&gt;<b>A&lt;MOO&gt;B&lt;/MOO&gt;C</b>&lt;/FOO&gt;&lt;/BAR&gt;
		(In this case, FOO is the parent of both boundary-points)
		After Range.selectNode(FOO):

		&lt;BAR&gt;<b>&lt;FOO&gt;A&lt;MOO&gt;B&lt;/MOO&gt;C&lt;/FOO&gt;</b>&lt;/BAR&gt;
		</pre></div></div><div class="div2"><a id="Level-2-Range-Comparing" name="Level-2-Range-Comparing"></a><h2 id="Level-2-Range-Comparing-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.5. Comparing Range Boundary-Points</h2><p>It is possible to compare two Ranges by comparing their boundary-points:</p><div class="eg"><pre style="margin-left: 2em; ">  short compareBoundaryPoints(in CompareHow how, in Range sourceRange) raises(RangeException);
		</pre></div><p>where&nbsp;<code>CompareHow</code>&nbsp;is one of four values:&nbsp;<code>START_TO_START</code>,&nbsp;<code>START_TO_END</code>,&nbsp;<code>END_TO_END</code>&nbsp;and&nbsp;<code>END_TO_START</code>. The return value is -1, 0 or 1 depending on whether the corresponding boundary-point of the Range is before, equal to, or after the corresponding boundary-point of&nbsp;<code>sourceRange</code>. An exception is thrown if the two Ranges have different&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-root-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>root container</em></a>s.</p><p>The result of comparing two boundary-points (or positions) is specified below. An informal but not always correct specification is that an boundary-point is before, equal to, or after another if it corresponds to a location in a text representation before, equal to, or after the other's corresponding location.</p><p><a id="td-comparison" name="td-comparison"></a>Let A and B be two boundary-points or positions. Then one of the following holds: A is&nbsp;<i>before</i>&nbsp;B, A is&nbsp;<i>equal to</i>&nbsp;B, or A is&nbsp;<i>after</i>&nbsp;B. Which one holds is specified in the following by examining four cases:</p><p>In the first case the boundary-points have the same&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>. A is&nbsp;<i>before</i>&nbsp;B if its&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;is less than the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of B, A is&nbsp;<i>equal to</i>&nbsp;B if its&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;is equal to the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of B, and A is&nbsp;<i>after</i>&nbsp;B if its&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;is greater than the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of B.</p><p>In the second case a child node C of the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of A is an&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>&nbsp;of B. In this case, A is&nbsp;<i>before</i>&nbsp;B if the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of A is less than or equal to the index of the child node C and A is&nbsp;<i>after</i>B otherwise.</p><p>In the third case a child node C of the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of B is an&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>&nbsp;of A. In this case, A is&nbsp;<i>before</i>&nbsp;B if the index of the child node C is less than the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of B and A is&nbsp;<i>after</i>&nbsp;B otherwise.</p><p>In the fourth case, none of three other cases hold: the containers of A and B are&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-sibling" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>siblings</em></a>&nbsp;or&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-descendant" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>descendants</em></a>&nbsp;of sibling nodes. In this case, A is&nbsp;<i>before</i>&nbsp;B if the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of A is before the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of B in a pre-order traversal of the Ranges'&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-context-tree" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>context tree</em></a>&nbsp;and A is&nbsp;<i>after</i>&nbsp;B otherwise.</p><p>Note that because the same location in a text representation of the document can correspond to two different positions in the DOM tree, it is possible for two boundary-points to not compare equal even though they would be equal in the text representation. For this reason, the informal definition above can sometimes be incorrect.</p></div><div class="div2"><a id="Level-2-Range-Deleting-Content" name="Level-2-Range-Deleting-Content"></a><h2 id="Level-2-Range-Deleting-Content-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.6. Deleting Content with a Range</h2><p>One can delete the contents selected by a Range with:</p><div class="eg"><pre style="margin-left: 2em; ">  void deleteContents();
		</pre></div><p><code>deleteContents()</code>&nbsp;deletes all nodes and characters selected by the Range. All other nodes and characters remain in the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-context-tree" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>context tree</em></a>&nbsp;of the Range. Some examples of this deletion operation are:</p><div class="eg"><pre style="margin-left: 2em; ">(1) &lt;FOO&gt;A<b>B&lt;MOO&gt;CD&lt;/MOO&gt;</b>CD&lt;/FOO&gt;  --&gt;
		&lt;FOO&gt;A<b>^</b>CD&lt;/FOO&gt;
		</pre></div><div class="eg"><pre style="margin-left: 2em; ">(2) &lt;FOO&gt;A&lt;MOO&gt;B<b>C&lt;/MOO&gt;D</b>E&lt;/FOO&gt;  --&gt;
		&lt;FOO&gt;A&lt;MOO&gt;B&lt;/MOO&gt;<b>^</b>E&lt;/FOO&gt;
		</pre></div><div class="eg"><pre style="margin-left: 2em; ">(3) &lt;FOO&gt;X<b>Y&lt;BAR&gt;Z</b>W&lt;/BAR&gt;Q&lt;/FOO&gt;  --&gt;
		&lt;FOO&gt;X<b>^</b>&lt;BAR&gt;W&lt;/BAR&gt;Q&lt;/FOO&gt;
		</pre></div><div class="eg"><pre style="margin-left: 2em; ">(4) &lt;FOO&gt;&lt;BAR1&gt;A<b>B&lt;/BAR1&gt;&lt;BAR2/&gt;&lt;BAR3&gt;C</b>D&lt;/BAR3&gt;&lt;/FOO&gt;
		--&gt;  &lt;FOO&gt;&lt;BAR1&gt;A&lt;/BAR1&gt;<b>^</b>&lt;BAR3&gt;D&lt;/BAR3&gt;
		</pre></div><p>After&nbsp;<code>deleteContents()</code>&nbsp;is invoked on a Range, the Range is&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-collapsed" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>collapsed</em></a>. If no node was&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-partially-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>partially selected</em></a>&nbsp;by the Range, then it is&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-collapsed" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>collapsed</em></a>&nbsp;to its original start point, as in example (1). If a node was&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-partially-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>partially selected</em></a>&nbsp;by the Range and was an&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>&nbsp;of the start of the Range and no&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-ancestor" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor</em></a>&nbsp;of the node satisfies these two conditions, then the Range is collapsed to the position immediately after the node, as in examples (2) and (4). If a node was&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-partially-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>partially selected</em></a>&nbsp;by the Range and was an&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>&nbsp;of the end of the Range and no ancestor of the node satisfies these two conditions, then the Range is collapsed to the position immediately before the node, as in examples (3) and (4).</p><p>Note that if deletion of a Range leaves adjacent Text nodes, they are not automatically merged, and empty Text nodes are not automatically removed. Two Text nodes should be joined only if each is the container of one of the boundary-points of a Range whose contents are deleted. To merge adjacent Text nodes, or remove empty text nodes, the&nbsp;<code>normalize()</code>&nbsp;method on the&nbsp;<code>Node</code>interface should be used.</p></div><div class="div2"><a id="Level-2-Range-Extracting" name="Level-2-Range-Extracting"></a><h2 id="Level-2-Range-Extracting-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.7. Extracting Content</h2><p>If the contents of a Range need to be extracted rather than deleted, the following method may be used:</p><div class="eg"><pre style="margin-left: 2em; ">  DocumentFragment extractContents();
		</pre></div><p>The&nbsp;<code>extractContents()</code>&nbsp;method removes nodes from the Range's&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-context-tree" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>context tree</em></a>&nbsp;similarly to the&nbsp;<code>deleteContents()</code>&nbsp;method. In addition, it places the deleted contents in a new&nbsp;<code>DocumentFragment</code>. The following examples illustrate the contents of the returned DocumentFragment:</p><div class="eg"><pre style="margin-left: 2em; ">(1) &lt;FOO&gt;A<b>B&lt;MOO&gt;CD&lt;/MOO&gt;</b>CD&lt;/FOO&gt;  --&gt;
		B&lt;MOO&gt;CD&lt;/MOO&gt;
		</pre></div><div class="eg"><pre style="margin-left: 2em; ">(2) &lt;FOO&gt;A&lt;MOO&gt;B<b>C&lt;/MOO&gt;D</b>E&lt;/FOO&gt;  --&gt;
		&lt;MOO&gt;C&lt;MOO&gt;D
		</pre></div><div class="eg"><pre style="margin-left: 2em; ">(3) &lt;FOO&gt;X<b>Y&lt;BAR&gt;Z</b>W&lt;/BAR&gt;Q&lt;/FOO&gt;  --&gt;
		Y&lt;BAR&gt;Z&lt;/BAR&gt;
		</pre></div><div class="eg"><pre style="margin-left: 2em; ">(4)
		&lt;FOO&gt;&lt;BAR1&gt;A<b>B&lt;/BAR1&gt;&lt;BAR2/&gt;&lt;BAR3&gt;C</b>D&lt;/BAR3&gt;&lt;/FOO&gt; --&gt;
		&lt;BAR1&gt;B&lt;/BAR1&gt;&lt;BAR2/&gt;&lt;BAR3&gt;C&lt;/BAR3&gt;
		</pre></div><p>It is important to note that nodes that are&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-partially-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>partially selected</em></a>&nbsp;by the Range are cloned. Since part of such a node's contents must remain in the Range's&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-context-tree" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>context tree</em></a>&nbsp;and part of the contents must be moved to the new DocumentFragment, a clone of the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-partially-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>partially selected</em></a>&nbsp;node is included in the new DocumentFragment. Note that cloning does not take place for&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>selected</em></a>&nbsp;elements; these nodes are moved to the new DocumentFragment.</p></div><div class="div2"><a id="Level-2-Range-Cloning" name="Level-2-Range-Cloning"></a><h2 id="Level-2-Range-Cloning-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.8. Cloning Content</h2><p>The contents of a Range may be duplicated using the following method:</p><div class="eg"><pre style="margin-left: 2em; ">  DocumentFragment cloneContents();
		</pre></div><p>This method returns a&nbsp;<code>DocumentFragment</code>&nbsp;that is similar to the one returned by the method&nbsp;<code>extractContents()</code>. However, in this case, the original nodes and character data in the Range are not removed from the Range's&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-context-tree" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>context tree</em></a>. Instead, all of the nodes and text content within the returned&nbsp;<code>DocumentFragment</code>&nbsp;are cloned.</p></div><div class="div2"><a id="Level-2-Range-Inserting" name="Level-2-Range-Inserting"></a><h2 id="Level-2-Range-Inserting-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.9. Inserting Content</h2><p>A node may be inserted into a Range using the following method:</p><div class="eg"><pre style="margin-left: 2em; ">  void insertNode(in Node n) raises(RangeException);
		</pre></div><p>The&nbsp;<code>insertNode()</code>&nbsp;method inserts the specified node into the Range's&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-context-tree" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>context tree</em></a>. The node is inserted at the start&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;of the Range, without modifying it.</p><p>If the start boundary point of the Range is in a&nbsp;<code>Text</code>&nbsp;node, the&nbsp;<code>insertNode</code>&nbsp;operation splits the&nbsp;<code>Text</code>&nbsp;node at the boundary point. If the node to be inserted is also a&nbsp;<code>Text</code>&nbsp;node, the resulting adjacent<code>Text</code>&nbsp;nodes are not normalized automatically; this operation is left to the application.</p><p>The Node passed into this method can be a&nbsp;<code>DocumentFragment</code>. In that case, the contents of the&nbsp;<code>DocumentFragment</code>&nbsp;are inserted at the start&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>boundary-point</em></a>&nbsp;of the Range, but the&nbsp;<code>DocumentFragment</code>itself is not. Note that if the Node represents the root of a sub-tree, the entire sub-tree is inserted.</p><p>The same rules that apply to the&nbsp;<code>insertBefore()</code>&nbsp;method on the Node interface apply here. Specifically, the Node passed in, if it already has a parent, will be removed from its existing position.</p></div><div class="div2"><a id="Level-2-Range-Surrounding" name="Level-2-Range-Surrounding"></a><h2 id="Level-2-Range-Surrounding-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.10. Surrounding Content</h2><p>The insertion of a single node to subsume the content selected by a Range can be performed with:</p><div class="eg"><pre style="margin-left: 2em; ">  void surroundContents(in Node newParent);
		</pre></div><p>The&nbsp;<code>surroundContents()</code>&nbsp;method causes all of the content selected by the Range to be rooted by the specified node. The nodes may not be Attr, Entity, DocumentType, Notation, Document, or DocumentFragment nodes. Calling&nbsp;<code>surroundContents()</code>&nbsp;with the Element node FOO in the following examples yields:</p><div class="eg"><pre style="margin-left: 2em; ">     Before:
		       &lt;BAR&gt;A<b>B&lt;MOO&gt;C&lt;/MOO&gt;D</b>E&lt;/BAR&gt;

		     After surroundContents(FOO):

		&lt;BAR&gt;A<b>&lt;FOO&gt;B&lt;MOO&gt;C&lt;/MOO&gt;D&lt;/FOO&gt;</b>E&lt;/BAR&gt;
		</pre></div><p>Another way of describing the effect of this method on the Range's&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-context-tree" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>context tree</em></a>&nbsp;is to decompose it in terms of other operations:</p><ol><li>Remove the contents selected by the Range with a call to&nbsp;<code>extractContents()</code>.</li><li>Insert the node&nbsp;<code>newParent</code>&nbsp;where the Range is collapsed (after the extraction) with&nbsp;<code>insertNode().</code></li><li>Insert the entire contents of the extracted DocumentFragment into&nbsp;<code>newParent</code>. Specifically, invoke the&nbsp;<code>appendChild()</code>&nbsp;on&nbsp;<code>newParent</code>&nbsp;passing in the DocumentFragment returned as a result of the call to&nbsp;<code>extractContents()</code></li><li>Select&nbsp;<code>newParent</code>&nbsp;and all of its contents with&nbsp;<code>selectNode()</code>.</li></ol><p>The&nbsp;<code>surroundContents()</code>&nbsp;method raises an exception if the Range&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-partially-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>partially selects</em></a>&nbsp;a non-Text node. An example of a Range for which&nbsp;<code>surroundContents()</code>raises an exception is:</p><div class="eg"><pre style="margin-left: 2em; ">     &lt;FOO&gt;A<b>B&lt;BAR&gt;C</b>D&lt;/BAR&gt;E&lt;/FOO&gt;
		</pre></div><p>If the node&nbsp;<code>newParent</code>&nbsp;has any children, those children are removed before its insertion. Also, if the node&nbsp;<code>newParent</code>&nbsp;already has a parent, it is removed from the original parent's&nbsp;<code>childNodes</code>&nbsp;list.</p></div><div class="div2"><a id="Level-2-Range-Misc" name="Level-2-Range-Misc"></a><h2 id="Level-2-Range-Misc-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.11. Miscellaneous Members</h2><p>One can clone a Range:</p><div class="eg"><pre style="margin-left: 2em; ">  Range cloneRange();
		</pre></div><p>This creates a new Range which selects exactly the same content as that selected by the Range on which the method&nbsp;<code>cloneRange</code>&nbsp;was invoked. No content is affected by this operation.</p><p>Because the boundary-points of a Range do not necessarily have the same&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>s, use:</p><div class="eg"><pre style="margin-left: 2em; ">  readonly attribute Node commonAncestorContainer;
		</pre></div><p>to get the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>&nbsp;of both boundary-points that is furthest down from the Range's&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-root-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>root container</em></a></p><p>One can get a copy of all the character data selected or partially selected by a Range with:</p><div class="eg"><pre style="margin-left: 2em; ">  DOMString toString();
		</pre></div><p>This does nothing more than simply concatenate all the character data selected by the Range. This includes character data in both&nbsp;<code>Text</code>&nbsp;and&nbsp;<code>CDATASection</code>&nbsp;nodes.</p></div><div class="div2"><a id="Level-2-Range-Mutation" name="Level-2-Range-Mutation"></a><h2 id="Level-2-Range-Mutation-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.12. Range modification under document mutation</h2><p>As a document is modified, the Ranges within the document need to be updated. For example, if one boundary-point of a Range is within a node and that node is removed from the document, then the Range would be invalid unless it is fixed up in some way. This section describes how Ranges are modified under document mutations so that they remain valid.</p><p>There are two general principles which apply to Ranges under document mutation: The first is that all Ranges in a document will remain valid after any mutation operation and the second is that, as much as possible, all Ranges will select the same portion of the document after any mutation operation.</p><p>Any mutation of the document tree which affect Ranges can be considered to be a combination of basic deletion and insertion operations. In fact, it can be convenient to think of those operations as being accomplished using the&nbsp;<code>deleteContents()</code>&nbsp;and&nbsp;<code>insertNode()</code>&nbsp;Range methods and, in the case of Text mutations, the&nbsp;<code>splitText()</code>&nbsp;and&nbsp;<code>normalize()</code>&nbsp;methods.</p><div class="div3"><a id="Level-2-Range-Insertions" name="Level-2-Range-Insertions"></a><h3 id="Level-2-Range-Insertions-h3" class="div3" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 19px; font-weight: normal; ">2.12.1. Insertions</h3><p>An insertion occurs at a single point, the insertion point, in the document. For any Range in the document tree, consider each boundary-point. The only case in which the boundary-point will be changed after the insertion is when the boundary-point and the insertion point have the same&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;and the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of the insertion point is strictly less than the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of the Range's boundary-point. In that case the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of the Range's boundary-point will be increased so that it is between the same nodes or characters as it was before the insertion.</p><p>Note that when content is inserted at a boundary-point, it is ambiguous as to where the boundary-point should be repositioned if its relative position is to be maintained. There are two possibilities: at the start or at the end of the newly inserted content. We have chosen that in this case neither the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;nor&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-offset" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>offset</em></a>&nbsp;of the boundary-point is changed. As a result, the boundary-point will be positioned at the start of the newly inserted content.</p><p><em>Examples:</em></p><p>Suppose the Range selects the following:</p><div class="eg"><pre style="margin-left: 2em; ">&lt;P&gt;Abcd efgh X<b>Y blah i</b>jkl&lt;/P&gt;
		</pre></div><p>Consider the insertion of the text "<i>inserted text</i>" at the following positions:</p><div class="eg"><pre style="margin-left: 2em; ">1. Before the 'X':

		&lt;P&gt;Abcd efgh <i>inserted text</i>X<b>Y blah i</b>jkl&lt;/P&gt;

		2. After the 'X':

		&lt;P&gt;Abcd efgh X<b><i>inserted text</i>Y blah i</b>jkl&lt;/P&gt;

		3. After the 'Y':

		&lt;P&gt;Abcd efgh X<b>Y<i>inserted text</i> blah i</b>jkl&lt;/P&gt;

		4. After the 'h' in "Y blah":

		&lt;P&gt;Abcd efgh X<b>Y blah<i>inserted text</i> i</b>jkl&lt;/P&gt;

		</pre></div></div><div class="div3"><a id="Level-2-Range-Deletions" name="Level-2-Range-Deletions"></a><h3 id="Level-2-Range-Deletions-h3" class="div3" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 19px; font-weight: normal; ">2.12.2. Deletions</h3><p>Any deletion from the document tree can be considered as a sequence of&nbsp;<code>deleteContents()</code>&nbsp;operations applied to a minimal set of disjoint Ranges. To specify how a Range is modified under deletions we need only consider what happens to a Range under a single&nbsp;<code>deleteContents()</code>operation of another Range. And, in fact, we need only consider what happens to a single boundary-point of the Range since both boundary-points are modified using the same algorithm.</p><p>If a boundary-point of the original Range is within the content being deleted, then after the deletion it will be at the same position as the resulting boundary-point of the (now&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-collapsed" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>collapsed</em></a>) Range used to delete the contents.</p><p>If a boundary-point is after the content being deleted then it is not affected by the deletion unless its&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;is also the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of one of the boundary-points of the Range being deleted. If there is such a common&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>, then the index of the boundary-point is modified so that the boundary-point maintains its position relative to the content of the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>.</p><p>If a boundary-point is before the content being deleted then it is not affected by the deletion at all.</p><p><em>Examples:</em></p><p>In these examples, the Range on which&nbsp;<code>deleteContents()</code>is invoked is indicated by the underline.</p><p><em>Example 1.</em></p><p>Before:</p><div class="eg"><pre style="margin-left: 2em; ">&lt;P&gt;Abcd <u>efgh T</u><b><u>he</u> Range i</b>jkl&lt;/P&gt;
		</pre></div><p>After:</p><div class="eg"><pre style="margin-left: 2em; ">&lt;P&gt;Abcd <b>Range i</b>jkl&lt;/P&gt;
		</pre></div><p><em>Example 2.</em></p><p>Before:</p><div class="eg"><pre style="margin-left: 2em; ">&lt;p&gt;Abcd <u>efgh T<b>he Range i</b>j</u>kl&lt;/p&gt;
		</pre></div><p>After:</p><div class="eg"><pre style="margin-left: 2em; ">&lt;p&gt;Abcd <b>^</b>kl&lt;/p&gt;
		</pre></div><p><em>Example 3.</em></p><p>Before:</p><div class="eg"><pre style="margin-left: 2em; ">&lt;P&gt;ABCD <u>efgh T</u><b><u>he &lt;EM&gt;R</u>ange</b>&lt;/EM&gt; ijkl&lt;/P&gt;
		</pre></div><p>After:</p><div class="eg"><pre style="margin-left: 2em; ">&lt;P&gt;ABCD &lt;EM&gt;<b>ange</b>&lt;/EM&gt; ijkl&lt;/P&gt;
		</pre></div><p>In this example, the container of the start boundary-point after the deletion is the Text node holding the string "ange".</p><p><em>Example 4.</em></p><p>Before:</p><div class="eg"><pre style="margin-left: 2em; ">&lt;P&gt;Abcd <u>efgh T</u><b>he Range i</b>jkl&lt;/P&gt;
		</pre></div><p>After:</p><div class="eg"><pre style="margin-left: 2em; ">&lt;P&gt;Abcd <b>he Range i</b>jkl&lt;/P&gt;
		</pre></div><p><em>Example 5.</em></p><p>Before:</p><div class="eg"><pre style="margin-left: 2em; ">&lt;P&gt;Abcd <u>&lt;EM&gt;efgh T<b>he Range i</b>j&lt;/EM&gt;</u>kl&lt;/P&gt;
		</pre></div><p>After:</p><div class="eg"><pre style="margin-left: 2em; ">&lt;P&gt;Abcd <b>^</b>kl&lt;/P&gt;
		</pre></div></div></div><div class="div2"><a id="Level-2-Range-Interface" name="Level-2-Range-Interface"></a><h2 id="Level-2-Range-Interface-h2" class="div2" style="text-align: left; color: rgb(0, 90, 156); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; font-size: 22px; font-weight: normal; ">2.13. Formal Description of the Range Interface</h2><p>To summarize, the complete, formal description of the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-idl" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>Range</code></a>&nbsp;interface is given below:</p><dl id="tbo"><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><b>Interface&nbsp;<i><a id="Level-2-Range-idl" name="Level-2-Range-idl">Range</a></i></b>&nbsp;(introduced in&nbsp;<b class="since">DOM Level 2</b>)</dt><dd style="margin-top: 0px; margin-bottom: 0px; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><br><b>IDL Definition</b></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="idl-code" style="font-family: monospace; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; white-space: pre; background-color: rgb(223, 223, 223); ">
		<pre style="margin-left: 2em; ">// Introduced in DOM Level 2:
		interface Range {
		  readonly attribute Node             startContainer;
		                                        // raises(DOMException) on retrieval

		  readonly attribute long             startOffset;
		                                        // raises(DOMException) on retrieval

		  readonly attribute Node             endContainer;
		                                        // raises(DOMException) on retrieval

		  readonly attribute long             endOffset;
		                                        // raises(DOMException) on retrieval

		  readonly attribute boolean          collapsed;
		                                        // raises(DOMException) on retrieval

		  readonly attribute Node             commonAncestorContainer;
		                                        // raises(DOMException) on retrieval

		  void               setStart(in Node refNode,
		                              in long offset)
		                                        raises(RangeException,
		                                               DOMException);
		  void               setEnd(in Node refNode,
		                            in long offset)
		                                        raises(RangeException,
		                                               DOMException);
		  void               setStartBefore(in Node refNode)
		                                        raises(RangeException,
		                                               DOMException);
		  void               setStartAfter(in Node refNode)
		                                        raises(RangeException,
		                                               DOMException);
		  void               setEndBefore(in Node refNode)
		                                        raises(RangeException,
		                                               DOMException);
		  void               setEndAfter(in Node refNode)
		                                        raises(RangeException,
		                                               DOMException);
		  void               collapse(in boolean toStart)
		                                        raises(DOMException);
		  void               selectNode(in Node refNode)
		                                        raises(RangeException,
		                                               DOMException);
		  void               selectNodeContents(in Node refNode)
		                                        raises(RangeException,
		                                               DOMException);

		  // CompareHow
		  const unsigned short      START_TO_START                 = 0;
		  const unsigned short      START_TO_END                   = 1;
		  const unsigned short      END_TO_END                     = 2;
		  const unsigned short      END_TO_START                   = 3;

		  short              compareBoundaryPoints(in unsigned short how,
		                                           in Range sourceRange)
		                                        raises(DOMException);
		  void               deleteContents()
		                                        raises(DOMException);
		  DocumentFragment   extractContents()
		                                        raises(DOMException);
		  DocumentFragment   cloneContents()
		                                        raises(DOMException);
		  void               insertNode(in Node newNode)
		                                        raises(DOMException,
		                                               RangeException);
		  void               surroundContents(in Node newParent)
		                                        raises(DOMException,
		                                               RangeException);
		  Range              cloneRange()
		                                        raises(DOMException);
		  DOMString          toString()
		                                        raises(DOMException);
		  void               detach()
		                                        raises(DOMException);
		};
		</pre>
		</div><br></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><b>Definition group&nbsp;<i><a id="Level2-Range-compareHow" name="Level2-Range-compareHow">CompareHow</a></i></b></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><p>Passed as a parameter to the&nbsp;<code>compareBoundaryPoints</code>&nbsp;method.</p><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><b>Defined Constants</b></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="constant-name" style="background-color: rgb(221, 255, 210); ">END_TO_END</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Compare end boundary-point of&nbsp;<code>sourceRange</code>&nbsp;to end boundary-point of Range on which&nbsp;<code>compareBoundaryPoints</code>&nbsp;is invoked.</dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="constant-name" style="background-color: rgb(221, 255, 210); ">END_TO_START</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Compare end boundary-point of&nbsp;<code>sourceRange</code>&nbsp;to start boundary-point of Range on which&nbsp;<code>compareBoundaryPoints</code>&nbsp;is invoked.</dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="constant-name" style="background-color: rgb(221, 255, 210); ">START_TO_END</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Compare start boundary-point of&nbsp;<code>sourceRange</code>&nbsp;to end boundary-point of Range on which&nbsp;<code>compareBoundaryPoints</code>&nbsp;is invoked.</dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="constant-name" style="background-color: rgb(221, 255, 210); ">START_TO_START</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Compare start boundary-point of&nbsp;<code>sourceRange</code>&nbsp;to start boundary-point of Range on which&nbsp;<code>compareBoundaryPoints</code>&nbsp;is invoked.</dd></dl></dd></dl></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><b>Attributes</b></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="attribute-name" style="background-color: rgb(255, 255, 210); "><a id="Level-2-Range-attr-collapsed" name="Level-2-Range-attr-collapsed">collapsed</a></code>&nbsp;of type&nbsp;<code>boolean</code>, readonly</dt><dd style="margin-top: 0px; margin-bottom: 0px; ">TRUE if the Range is collapsed<br><div class="exceptions"><b>Exceptions on retrieval</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="attribute-name" style="background-color: rgb(255, 255, 210); "><a id="Level-2-Range-attr-commonParent" name="Level-2-Range-attr-commonParent">commonAncestorContainer</a></code>&nbsp;of type&nbsp;<code>Node</code>, readonly</dt><dd style="margin-top: 0px; margin-bottom: 0px; ">The&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-deepest" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>deepest</em></a>&nbsp;common&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>&nbsp;of the Range's two boundary-points.<br><div class="exceptions"><b>Exceptions on retrieval</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="attribute-name" style="background-color: rgb(255, 255, 210); "><a id="Level-2-Range-attr-endParent" name="Level-2-Range-attr-endParent">endContainer</a></code>&nbsp;of type&nbsp;<code>Node</code>, readonly</dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Node within which the Range ends<br><div class="exceptions"><b>Exceptions on retrieval</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="attribute-name" style="background-color: rgb(255, 255, 210); "><a id="Level-2-Range-attr-endOffset" name="Level-2-Range-attr-endOffset">endOffset</a></code>&nbsp;of type&nbsp;<code>long</code>, readonly</dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Offset within the ending node of the Range.<br><div class="exceptions"><b>Exceptions on retrieval</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="attribute-name" style="background-color: rgb(255, 255, 210); "><a id="Level-2-Range-attr-startParent" name="Level-2-Range-attr-startParent">startContainer</a></code>&nbsp;of type&nbsp;<code>Node</code>, readonly</dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Node within which the Range begins<br><div class="exceptions"><b>Exceptions on retrieval</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="attribute-name" style="background-color: rgb(255, 255, 210); "><a id="Level-2-Range-attr-startOffset" name="Level-2-Range-attr-startOffset">startOffset</a></code>&nbsp;of type&nbsp;<code>long</code>, readonly</dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Offset within the starting node of the Range.<br><div class="exceptions"><b>Exceptions on retrieval</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div></dd></dl></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><b>Methods</b></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-cloneContents" name="Level2-Range-method-cloneContents">cloneContents</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Duplicates the contents of a Range<div class="return"><b>Return Value</b><div class="returntable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the return value, the second contains a short description" border="0"><tbody><tr><td valign="top"><p><code>DocumentFragment</code></p></td><td><p>A DocumentFragment that contains content equivalent to this Range.</p></td></tr></tbody></table></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>HIERARCHY_REQUEST_ERR: Raised if a DocumentType node would be extracted into the new DocumentFragment.</p><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Parameters</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-clone" name="Level2-Range-method-clone">cloneRange</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Produces a new Range whose boundary-points are equal to the boundary-points of the Range.<div class="return"><b>Return Value</b><div class="returntable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the return value, the second contains a short description" border="0"><tbody><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-idl" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>Range</code></a></p></td><td><p>The duplicated Range.</p></td></tr></tbody></table></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Parameters</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-collapse" name="Level2-Range-method-collapse">collapse</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Collapse a Range onto one of its boundary-points<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">toStart</code>&nbsp;of type&nbsp;<code>boolean</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">If TRUE, collapses the Range onto its start; if FALSE, collapses it onto its end.<br></dd></dl></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-compareBoundaryPoints" name="Level2-Range-method-compareBoundaryPoints">compareBoundaryPoints</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Compare the boundary-points of two Ranges in a document.<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">how</code>&nbsp;of type&nbsp;<code>unsigned short</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">A code representing the type of comparison, as defined above.<br></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">sourceRange</code>&nbsp;of type&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-idl" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>Range</code></a></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">The&nbsp;<code>Range</code>&nbsp;on which this current&nbsp;<code>Range</code>&nbsp;is compared to.<br></dd></dl></div></div><div class="return"><b>Return Value</b><div class="returntable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the return value, the second contains a short description" border="0"><tbody><tr><td valign="top"><p><code>short</code></p></td><td><p>-1, 0 or 1 depending on whether the corresponding boundary-point of the Range is respectively before, equal to, or after the corresponding boundary-point of<code>sourceRange</code>.</p></td></tr></tbody></table></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>WRONG_DOCUMENT_ERR: Raised if the two Ranges are not in the same Document or DocumentFragment.</p><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-deleteContents" name="Level2-Range-method-deleteContents">deleteContents</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Removes the contents of a Range from the containing document or document fragment without returning a reference to the removed content.<div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>NO_MODIFICATION_ALLOWED_ERR: Raised if any portion of the content of the Range is read-only or any of the nodes that contain any of the content of the Range are read-only.</p><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Parameters</b></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-detach" name="Level2-Range-method-detach">detach</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Called to indicate that the Range is no longer in use and that the implementation may relinquish any resources associated with this Range. Subsequent calls to any methods or attribute getters on this Range will result in a&nbsp;<code>DOMException</code>&nbsp;being thrown with an error code of&nbsp;<code>INVALID_STATE_ERR</code>.<div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Parameters</b></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-extractContents" name="Level2-Range-method-extractContents">extractContents</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Moves the contents of a Range from the containing document or document fragment to a new DocumentFragment.<div class="return"><b>Return Value</b><div class="returntable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the return value, the second contains a short description" border="0"><tbody><tr><td valign="top"><p><code>DocumentFragment</code></p></td><td><p>A DocumentFragment containing the extracted contents.</p></td></tr></tbody></table></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>NO_MODIFICATION_ALLOWED_ERR: Raised if any portion of the content of the Range is read-only or any of the nodes which contain any of the content of the Range are read-only.</p><p>HIERARCHY_REQUEST_ERR: Raised if a DocumentType node would be extracted into the new DocumentFragment.</p><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Parameters</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-insertNode" name="Level2-Range-method-insertNode">insertNode</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Inserts a node into the Document or DocumentFragment at the start of the Range. If the container is a Text node, this will be split at the start of the Range (as if the Text node's splitText method was performed at the insertion point) and the insertion will occur between the two resulting Text nodes. Adjacent Text nodes will not be automatically merged. If the node to be inserted is a DocumentFragment node, the children will be inserted rather than the DocumentFragment node itself.<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">newNode</code>&nbsp;of type&nbsp;<code>Node</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">The node to insert at the start of the Range<br></dd></dl></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>NO_MODIFICATION_ALLOWED_ERR: Raised if an&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>&nbsp;of the start of the Range is read-only.</p><p>WRONG_DOCUMENT_ERR: Raised if&nbsp;<code>newNode</code>&nbsp;and the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of the start of the Range were not created from the same document.</p><p>HIERARCHY_REQUEST_ERR: Raised if the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of the start of the Range is of a type that does not allow children of the type of&nbsp;<code>newNode</code>&nbsp;or if&nbsp;<code>newNode</code>is an ancestor of the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>.</p><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>RangeException</code></a></p></td><td><p>INVALID_NODE_TYPE_ERR: Raised if&nbsp;<code>newNode</code>&nbsp;is an Attr, Entity, Notation, or Document node.</p></td></tr></tbody></table></div></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-selectNode" name="Level2-Range-method-selectNode">selectNode</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Select a node and its contents<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">refNode</code>&nbsp;of type&nbsp;<code>Node</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">The node to select.<br></dd></dl></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>RangeException</code></a></p></td><td><p>INVALID_NODE_TYPE_ERR: Raised if an ancestor of&nbsp;<code>refNode</code>&nbsp;is an Entity, Notation or DocumentType node or if&nbsp;<code>refNode</code>&nbsp;is a Document, DocumentFragment, Attr, Entity, or Notation node.</p></td></tr><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-selectNodeContents" name="Level2-Range-method-selectNodeContents">selectNodeContents</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Select the contents within a node<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">refNode</code>&nbsp;of type&nbsp;<code>Node</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Node to select from<br></dd></dl></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>RangeException</code></a></p></td><td><p>INVALID_NODE_TYPE_ERR: Raised if&nbsp;<code>refNode</code>&nbsp;or an ancestor of&nbsp;<code>refNode</code>&nbsp;is an Entity, Notation or DocumentType node.</p></td></tr><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-setEnd" name="Level2-Range-method-setEnd">setEnd</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Sets the attributes describing the end of a Range.<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">refNode</code>&nbsp;of type&nbsp;<code>Node</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">The&nbsp;<code>refNode</code>&nbsp;value. This parameter must be different from&nbsp;<code>null</code>.<br></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">offset</code>&nbsp;of type&nbsp;<code>long</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">The&nbsp;<code>endOffset</code>&nbsp;value.<br></dd></dl></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>RangeException</code></a></p></td><td><p>INVALID_NODE_TYPE_ERR: Raised if&nbsp;<code>refNode</code>&nbsp;or an ancestor of&nbsp;<code>refNode</code>&nbsp;is an Entity, Notation, or DocumentType node.</p></td></tr><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INDEX_SIZE_ERR: Raised if&nbsp;<code>offset</code>&nbsp;is negative or greater than the number of child units in&nbsp;<code>refNode</code>. Child units are&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-16-bit-unit" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>16-bit units</em></a>&nbsp;if&nbsp;<code>refNode</code>&nbsp;is a type of CharacterData node (e.g., a Text or Comment node) or a ProcessingInstruction node. Child units are Nodes in all other cases.</p><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-setEndAfter" name="Level2-Range-method-setEndAfter">setEndAfter</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Sets the end of a Range to be after a node<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">refNode</code>&nbsp;of type&nbsp;<code>Node</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Range ends after&nbsp;<code>refNode</code>.<br></dd></dl></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>RangeException</code></a></p></td><td><p>INVALID_NODE_TYPE_ERR: Raised if the root container of&nbsp;<code>refNode</code>&nbsp;is not an Attr, Document or DocumentFragment node or if&nbsp;<code>refNode</code>&nbsp;is a Document, DocumentFragment, Attr, Entity, or Notation node.</p></td></tr><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-setEndBefore" name="Level2-Range-method-setEndBefore">setEndBefore</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Sets the end position to be before a node.<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">refNode</code>&nbsp;of type&nbsp;<code>Node</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Range ends before&nbsp;<code>refNode</code><br></dd></dl></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>RangeException</code></a></p></td><td><p>INVALID_NODE_TYPE_ERR: Raised if the root container of&nbsp;<code>refNode</code>&nbsp;is not an Attr, Document, or DocumentFragment node or if&nbsp;<code>refNode</code>&nbsp;is a Document, DocumentFragment, Attr, Entity, or Notation node.</p></td></tr><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-setStart" name="Level2-Range-method-setStart">setStart</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Sets the attributes describing the start of the Range.<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">refNode</code>&nbsp;of type&nbsp;<code>Node</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">The&nbsp;<code>refNode</code>&nbsp;value. This parameter must be different from&nbsp;<code>null</code>.<br></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">offset</code>&nbsp;of type&nbsp;<code>long</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">The&nbsp;<code>startOffset</code>&nbsp;value.<br></dd></dl></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>RangeException</code></a></p></td><td><p>INVALID_NODE_TYPE_ERR: Raised if&nbsp;<code>refNode</code>&nbsp;or an ancestor of&nbsp;<code>refNode</code>&nbsp;is an Entity, Notation, or DocumentType node.</p></td></tr><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INDEX_SIZE_ERR: Raised if&nbsp;<code>offset</code>&nbsp;is negative or greater than the number of child units in&nbsp;<code>refNode</code>. Child units are&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/glossary.html#dt-16-bit-unit" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>16-bit units</em></a>&nbsp;if&nbsp;<code>refNode</code>&nbsp;is a type of CharacterData node (e.g., a Text or Comment node) or a ProcessingInstruction node. Child units are Nodes in all other cases.</p><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-setStartAfter" name="Level2-Range-method-setStartAfter">setStartAfter</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Sets the start position to be after a node<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">refNode</code>&nbsp;of type&nbsp;<code>Node</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Range starts after&nbsp;<code>refNode</code><br></dd></dl></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>RangeException</code></a></p></td><td><p>INVALID_NODE_TYPE_ERR: Raised if the root container of&nbsp;<code>refNode</code>&nbsp;is not an Attr, Document, or DocumentFragment node or if&nbsp;<code>refNode</code>&nbsp;is a Document, DocumentFragment, Attr, Entity, or Notation node.</p></td></tr><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-setStartBefore" name="Level2-Range-setStartBefore">setStartBefore</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Sets the start position to be before a node<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">refNode</code>&nbsp;of type&nbsp;<code>Node</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">Range starts before&nbsp;<code>refNode</code><br></dd></dl></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>RangeException</code></a></p></td><td><p>INVALID_NODE_TYPE_ERR: Raised if the root container of&nbsp;<code>refNode</code>&nbsp;is not an Attr, Document, or DocumentFragment node or if&nbsp;<code>refNode</code>&nbsp;is a Document, DocumentFragment, Attr, Entity, or Notation node.</p></td></tr><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-surroundContents" name="Level2-Range-method-surroundContents">surroundContents</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Reparents the contents of the Range to the given node and inserts the node at the position of the start of the Range.<div class="parameters"><b>Parameters</b><div class="paramtable" style="margin-left: 1em; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="parameter-name" style="background-color: rgb(254, 230, 248); ">newParent</code>&nbsp;of type&nbsp;<code>Node</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">The node to surround the contents with.<br></dd></dl></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>NO_MODIFICATION_ALLOWED_ERR: Raised if an&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-ancestor-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>ancestor container</em></a>&nbsp;of either boundary-point of the Range is read-only.</p><p>WRONG_DOCUMENT_ERR: Raised if&nbsp;<code>newParent</code>&nbsp;and the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of the start of the Range were not created from the same document.</p><p>HIERARCHY_REQUEST_ERR: Raised if the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of the start of the Range is of a type that does not allow children of the type of&nbsp;<code>newParent</code>&nbsp;or if<code>newParent</code>&nbsp;is an ancestor of the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;or if&nbsp;<code>node</code>&nbsp;would end up with a child node of a type not allowed by the type of&nbsp;<code>node</code>.</p><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>RangeException</code></a></p></td><td><p>BAD_BOUNDARYPOINTS_ERR: Raised if the Range&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-partially-selected" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>partially selects</em></a>&nbsp;a non-text node.</p><p>INVALID_NODE_TYPE_ERR: Raised if&nbsp;<code>node</code>&nbsp;is an Attr, Entity, DocumentType, Notation, Document, or DocumentFragment node.</p></td></tr></tbody></table></div></div><div><b>No Return Value</b></div></div></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-Range-method-toString" name="Level2-Range-method-toString">toString</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">Returns the contents of a Range as a string. This string contains only the data characters, not any markup.<div class="return"><b>Return Value</b><div class="returntable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the return value, the second contains a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMString</code></p></td><td><p>The contents of the Range.</p></td></tr></tbody></table></div></div><div class="exceptions"><b>Exceptions</b><div class="exceptiontable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the exception, the second contains the specific error code and a short description" border="0"><tbody><tr><td valign="top"><p><code>DOMException</code></p></td><td><p>INVALID_STATE_ERR: Raised if&nbsp;<code>detach()</code>&nbsp;has already been invoked on this object.</p></td></tr></tbody></table></div></div><div><b>No Parameters</b></div></div></dd></dl></dd></dl></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><b>Interface&nbsp;<i><a id="Level-2-DocumentRange-idl" name="Level-2-DocumentRange-idl">DocumentRange</a></i></b>&nbsp;(introduced in&nbsp;<b class="since">DOM Level 2</b>)</dt><dd style="margin-top: 0px; margin-bottom: 0px; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><br><b>IDL Definition</b></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="idl-code" style="font-family: monospace; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; white-space: pre; background-color: rgb(223, 223, 223); ">
		<pre style="margin-left: 2em; ">// Introduced in DOM Level 2:
		interface DocumentRange {
		  Range              createRange();
		};
		</pre>
		</div><br></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><b>Methods</b></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="method-name" style="background-color: rgb(217, 230, 248); "><a id="Level2-DocumentRange-method-createRange" name="Level2-DocumentRange-method-createRange">createRange</a></code></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="method">This interface can be obtained from the object implementing the&nbsp;<code>Document</code>&nbsp;interface using binding-specific casting methods.<div class="return"><b>Return Value</b><div class="returntable" style="margin-left: 1em; "><table summary="Layout table: the first cell contains the type of the return value, the second contains a short description" border="0"><tbody><tr><td valign="top"><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-idl" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>Range</code></a></p></td><td><p>The initial state of the Range returned from this method is such that both of its boundary-points are positioned at the beginning of the corresponding Document, before any content. The Range returned can only be used to select content associated with this Document, or with DocumentFragments and Attrs for which this Document is the&nbsp;<code>ownerDocument</code>.</p></td></tr></tbody></table></div></div><div><b>No Parameters</b></div><div><b>No Exceptions</b></div></div></dd></dl></dd></dl></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><b>Exception&nbsp;<i><a id="RangeException" name="RangeException">RangeException</a></i></b>&nbsp;introduced in&nbsp;<b class="version">DOM Level 2</b></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><p>Range operations may throw a&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#RangeException" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><code>RangeException</code></a>&nbsp;as specified in their method descriptions.</p><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><br><b>IDL Definition</b></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><div class="idl-code" style="font-family: monospace; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; white-space: pre; background-color: rgb(223, 223, 223); ">
		<pre style="margin-left: 2em; ">// Introduced in DOM Level 2:
		exception RangeException {
		  unsigned short   code;
		};
		// RangeExceptionCode
		const unsigned short      BAD_BOUNDARYPOINTS_ERR         = 1;
		const unsigned short      INVALID_NODE_TYPE_ERR          = 2;
		</pre>
		</div><br></dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><b>Definition group&nbsp;<i><a id="RangeExceptionCode" name="RangeExceptionCode">RangeExceptionCode</a></i></b></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><p>An integer indicating the type of error generated.</p><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><b>Defined Constants</b></dt><dd style="margin-top: 0px; margin-bottom: 0px; "><dl><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="constant-name" style="background-color: rgb(221, 255, 210); ">BAD_BOUNDARYPOINTS_ERR</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">If the boundary-points of a Range do not meet specific requirements.</dd><dt style="margin-top: 0px; margin-bottom: 0px; font-weight: bold; "><code class="constant-name" style="background-color: rgb(221, 255, 210); ">INVALID_NODE_TYPE_ERR</code></dt><dd style="margin-top: 0px; margin-bottom: 0px; ">If the&nbsp;<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-container" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; "><em>container</em></a>&nbsp;of an boundary-point of a Range is being set to either a node of an invalid type or a node with an ancestor of an invalid type.</dd></dl></dd></dl></dd></dl></dd></dl></div></div><div class="navbar" align="center" style="color: rgb(0, 0, 0); font-family: sans-serif; font-size: medium; "><hr title="Navigation area separator"><a accesskey="p" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/traversal.html" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">previous</a>&nbsp;&nbsp;&nbsp;<a accesskey="n" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/idl-definitions.html" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">next</a>&nbsp;&nbsp;&nbsp;<a accesskey="c" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/Overview.html#contents" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">contents</a>&nbsp;&nbsp;&nbsp;<a accesskey="i" href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/def-index.html" style="color: rgb(102, 0, 153); background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; background-position: initial initial; background-repeat: initial initial; ">index</a></div></p><dl>
				</dl>
	</textarea>
	<div id="dev">
		<h2>Debug &#9829</h2>
		<p>
			<span>Mouse over: <span id="over"></span></span>
			<span style="float: right">Mouse Y-pos.: <span id="my"></span></span>
		</p>
		<hr>
		<dl>
			<dt>Trigger:</dt>
			<dd>
				<span id="tr_type"></span>
				<span id="tr_upper"></span>
				<span id="tr_lower"></span>
				<span id="tr_edge"></span>
			</dd>
		</dl>
		<hr>
		<p>Hidden state: <span id="hid"></span></p>
		<hr>
		<p>Exec time: <span id="time"></span></p>
	</div>
	<script>
		( function()
		{
			'use strict';

			CKEDITOR.config.extraPlugins =
				'button,' +
				'toolbar,' +
				'horizontalrule,' +
				'showblocks,' +
				'sourcearea,' +
				'magicbox,' +
				'wysiwygarea';

			CKEDITOR.config.height = 600;
			CKEDITOR.config.width = 800;

			CKEDITOR.replace( 'editor1' );
			CKEDITOR.replace( 'editor2' );

		})();
	</script>
</body>
</html>
