<!DOCTYPE html>
<!--
Copyright (c) 2003-2015, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.md or http://ckeditor.com/license
-->
<html>
<head>
	<meta charset="utf-8">
	<title>Toolbar Editor</title>
	<script src="../../ckeditor.js"></script>
	<script>
		if ( CKEDITOR.env.ie && CKEDITOR.env.version < 9 )
			CKEDITOR.tools.enableHtml5Elements( document );
	</script>
	<link rel="stylesheet" href="css/lib/codemirror.css">
	<link rel="stylesheet" href="css/lib/show-hint.css">
	<link rel="stylesheet" href="css/fontello.css">
	<link rel="stylesheet" href="css/toolbarmodifier.css">
	<link rel="stylesheet" href="../css/sample.css">
</head>
<body>

<header>
	<div>
		<h1>
			<a href="index.html"><img src="../img/logo.png" alt="CKEditor Sample"></a>
		</h1>
		<nav class="navigation main-navigation">
			<ul>
				<li><a href="../index.html">Demo</a></li>
				<li><a href="index.html" class="active">Toolbar configurator</a></li>
			</ul>
		</nav>
	</div>
	<nav class="navigation top-navigation">
		<div>
			<ul>
				<li><a href="http://ckeditor.com">Project Homepage</a></li>
				<li><a href="http://dev.ckeditor.com/">I found a bug</a></li>
				<li><a href="http://github.com/ckeditor/ckeditor-dev" class="fork">Fork CKEditor on GitHub</a></li>
			</ul>
			<ul class="right">
				<li><a href="http://ckeditor.com/blog-list">CKEditor Blog</a></li>
			</ul>
		</div>
	</nav>
</header>

<main>
	<section class="adjoined">
		<div>
			<h1>Toolbar configurator</h1>
			<span class="mode-switch">
				<span id="mode-switch-basic" class="fancy-button fancy-button-red fancy-button-active">Basic</span>
				<span id="mode-switch-advanced" class="fancy-button fancy-button-red">Advanced</span>
				<span class="fancy-tip">Select configurator type</span>
			</span>
			<div class="editors-container">
				<div id="editor-basic"></div>
				<div id="editor-advanced"></div>
			</div>
		</div>
	</section>
	<section>
		<div>
			<div id="toolbarModifierWrapper"></div>
		</div>
	</section>

	<script src="js/lib/codemirror/codemirror.js"></script>
	<script src="js/lib/codemirror/javascript.js"></script>
	<script src="js/lib/codemirror/show-hint.js"></script>

	<script src="js/fulltoolbareditor.js"></script>
	<script src="js/abstracttoolbarmodifier.js"></script>
	<script src="js/toolbarmodifier.js"></script>

	<script src="js/toolbartextmodifier.js"></script>

	<script>
		( function() {
			var mode = 'basic',
				ready = false;

			// Basic, configurator.
			CKEDITOR.replace( 'editor-basic' );

			function onRefresh( modifier ) {
				modifier = modifier || this;

				if ( mode === 'basic' && modifier instanceof ToolbarEditor.ToolbarTextModifier ) {
					return;
				}

				var editorContainer = modifier.editorInstance.container;
				var newHeight = editorContainer.getComputedStyle( 'height' ).replace( 'px', '' );
				newHeight = ( isNaN( newHeight ) ? 0 : Number( newHeight ) );

				var newMarginTop = editorContainer.getComputedStyle( 'margin-top' ).replace( 'px', '' );
				newMarginTop = ( isNaN( newMarginTop ) ? 0 : Number( newMarginTop ) );

				var newMarginBottom = editorContainer.getComputedStyle( 'margin-bottom' ).replace( 'px', '' );
				newMarginBottom = ( isNaN( newMarginBottom ) ? 0 : Number( newMarginBottom ) );

				var result = newHeight + newMarginTop + newMarginBottom;

				console.log( 'height', result );
				modifier.editorInstance.container.getAscendant( 'div' ).setStyle( 'height', result + 'px' );
			}

			var editorsContainer = CKEDITOR.document.findOne( '.editors-container' ),
				toolbarModifier = new ToolbarEditor.ToolbarModifier( 'editor-basic' ),
				toolbarModifierContainer = toolbarModifier.init();

			toolbarModifier.onRefresh = onRefresh;

			CKEDITOR.document.getById( 'toolbarModifierWrapper' ).append( toolbarModifierContainer );

			// Advanced configurator.
			CKEDITOR.replace( 'editor-advanced' );

			var toolbarTextModifier = new ToolbarEditor.ToolbarTextModifier( 'editor-advanced' ),
				toolbarTextModifierContainer = toolbarTextModifier.init( function() {
					mode = 'basic';
					toogleModeSwitch(
						modeSwitchBasic,
						modeSwitchAdvanced,
						toolbarModifier,
						toolbarTextModifier
					);

					setTimeout( function() {
						editorsContainer.addClass( 'active' );
					}, 200 );
				} );

			toolbarTextModifier.onRefresh = onRefresh;

			CKEDITOR.document.getById( 'toolbarModifierWrapper' ).append( toolbarTextModifierContainer );

			// Configurator mode switcher.
			var modeSwitchBasic = CKEDITOR.document.getById( 'mode-switch-basic' ),
				modeSwitchAdvanced = CKEDITOR.document.getById( 'mode-switch-advanced' );

			function toogleModeSwitch( onElement, offElement, onModifier, offModifier ) {
				onElement.addClass( 'fancy-button-active' );
				offElement.removeClass( 'fancy-button-active' );

				onModifier.showUI();
				offModifier.hideUI();
			}

			function toggleModeBasic() {
				mode = 'basic';
				toogleModeSwitch( this, modeSwitchAdvanced, toolbarModifier, toolbarTextModifier );
				onRefresh( toolbarModifier );
			}

			function toggleModeAdvanced() {
				mode = 'advanced';
				toogleModeSwitch( this, modeSwitchBasic, toolbarTextModifier, toolbarModifier );
				onRefresh( toolbarTextModifier );
			}

			modeSwitchBasic.on( 'click', toggleModeBasic );
			modeSwitchAdvanced.on( 'click', toggleModeAdvanced );
		} )();
	</script>
</main>

<footer>
	<div>
		<p>
			CKEditor - The text editor for the Internet - <a class="samples" href="http://ckeditor.com/">http://ckeditor.com</a>
		</p>
		<p id="copy">
			Copyright &copy; 2003-2015, <a class="samples" href="http://cksource.com/">CKSource</a> - Frederico Knabben. All rights reserved.
		</p>
	</div>
</footer>

</body>
</html>
